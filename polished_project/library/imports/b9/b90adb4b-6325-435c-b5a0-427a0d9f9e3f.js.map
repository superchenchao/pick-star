{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\GameOver.js"],"names":["GameConfig","require","AnimLayerTool","GameTools","GameUiTools","cc","Class","extends","Component","properties","backColor","Node","game_over","scoreLabel","Label","bestScoreLabel","rankButton","shareButton","backButton","restartButton","rankingScrollView","Sprite","onLoad","string","GameCore","GameHeightScore","submitScore","CC_WECHATGAME","tex","Texture2D","window","sharedCanvas","width","height","wx","postMessage","messageType","MAIN_MENU_NUM","log","getParent","active","setButtonClickEvents","showAnimation","buttonFunc","event","button","target","playSimpleAudioEngine","getRankData","setTimeout","sharePicture","restartResource","sceneName","removeRankData","loadingScene","_updateSubDomainCanvas","undefined","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","update","isShow","bottonAnim"],"mappings":"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","file":"GameOver.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["var GameConfig = require(\"GameConfig\");\r\nvar AnimLayerTool = require(\"AnimLayerTool\");\r\nvar GameTools = require(\"GameTools\");\r\nvar GameUiTools = require(\"GameUiTools\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        backColor: cc.Node,\r\n        game_over: cc.Node,\r\n        scoreLabel: cc.Label,\r\n        bestScoreLabel: cc.Label,\r\n        rankButton: cc.Node, //排行榜按钮\r\n        shareButton: cc.Node, //分享按钮\r\n        backButton: cc.Node, //返回按钮\r\n        restartButton: cc.Node, //重新开始按钮\r\n        rankingScrollView: cc.Sprite,//显示排行榜\r\n    },\r\n\r\n    onLoad () {\r\n        this.scoreLabel.string = GameConfig.GameCore;\r\n        this.bestScoreLabel.string = GameConfig.GameHeightScore;\r\n        GameTools.submitScore(GameConfig.GameHeightScore); //提交得分\r\n        if (CC_WECHATGAME) {\r\n            this.tex = new cc.Texture2D();\r\n            window.sharedCanvas.width = 960;\r\n            window.sharedCanvas.height = 640;\r\n            window.wx.postMessage({// 发消息给子域\r\n                messageType: 4,\r\n                MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\r\n            });\r\n        } else {\r\n            cc.log(\"获取排行榜数据。\" + GameConfig.MAIN_MENU_NUM);\r\n            this.rankButton.getParent().active = false;\r\n        }\r\n\r\n        GameUiTools.setButtonClickEvents(this, this.rankButton, \"buttonFunc\");\r\n        GameUiTools.setButtonClickEvents(this, this.shareButton, \"buttonFunc\");\r\n        GameUiTools.setButtonClickEvents(this, this.backButton, \"buttonFunc\");\r\n        GameUiTools.setButtonClickEvents(this, this.restartButton, \"buttonFunc\");\r\n        this.showAnimation(true);\r\n    },\r\n\r\n    buttonFunc: function (event) {\r\n        let button = event.target;\r\n        if (this.rankButton == button) {\r\n            GameTools.playSimpleAudioEngine(0);\r\n            GameTools.getRankData();\r\n        } else if (this.shareButton == button) {\r\n            GameTools.playSimpleAudioEngine(0);\r\n            setTimeout(() => {\r\n                GameTools.sharePicture();\r\n            }, 100);\r\n        } else if (this.restartButton == button) {\r\n            GameTools.playSimpleAudioEngine(0);\r\n            this.restartResource(\"game\");\r\n        } else if (this.backButton == button) {\r\n            GameTools.playSimpleAudioEngine(0);\r\n            this.restartResource(\"prepare\");\r\n        }\r\n        return true;\r\n    },\r\n    restartResource(sceneName) {\r\n        GameTools.removeRankData();\r\n        GameUiTools.loadingScene(sceneName)\r\n    },\r\n    // 刷新子域的纹理\r\n    _updateSubDomainCanvas() {\r\n        if (CC_WECHATGAME) {\r\n            if (window.sharedCanvas != undefined) {\r\n                this.tex.initWithElement(window.sharedCanvas);\r\n                this.tex.handleLoadedTexture();\r\n                this.rankingScrollView.spriteFrame = new cc.SpriteFrame(this.tex);\r\n            }\r\n        }\r\n    },\r\n    update() {\r\n        this._updateSubDomainCanvas();\r\n    },\r\n    showAnimation(isShow) {\r\n        if (isShow) {\r\n            AnimLayerTool.bottonAnim(this.game_over);\r\n            AnimLayerTool.bottonAnim(this.shareButton);\r\n            AnimLayerTool.bottonAnim(this.restartButton);\r\n            AnimLayerTool.bottonAnim(this.backButton);\r\n        }\r\n    }\r\n\r\n});\r\n"]}