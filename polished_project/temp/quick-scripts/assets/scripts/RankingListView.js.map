{"version":3,"sources":["RankingListView.js"],"names":["GameConfig","require","AnimLayerTool","GameTools","GameUiTools","cc","Class","extends","Component","properties","backButton","Node","shareButton","rankingScrollView","Sprite","shareTicket","onLoad","showAnimation","start","setButtonClickEvents","shareNode","addComponent","Label","string","setPosition","node","addChild","CC_WECHATGAME","tex","Texture2D","window","sharedCanvas","width","height","log","wx","postMessage","messageType","MAIN_MENU_NUM","gameTypeNode","shareButtonFunc","event","playSimpleAudioEngine","setTimeout","sharePicture","backButtonFunc","removeRankData","destroy","_updateSubDomainCanvas","undefined","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","update","isShow","bottonAnim"],"mappings":"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","file":"RankingListView.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["var GameConfig = require(\"GameConfig\");\nvar AnimLayerTool = require(\"AnimLayerTool\");\nvar GameTools = require(\"GameTools\");\nvar GameUiTools = require(\"GameUiTools\");\ncc.Class({\n    extends: cc.Component,\n    // name: \"RankingListView\",\n    properties: {\n        backButton: cc.Node,\n        shareButton: cc.Node,\n        rankingScrollView: cc.Sprite,//显示排行榜\n        shareTicket: null,\n    },\n    onLoad() {\n        this.showAnimation(true);\n    },\n    start() {\n        GameUiTools.setButtonClickEvents(this, this.backButton, \"backButtonFunc\");\n        GameUiTools.setButtonClickEvents(this, this.shareButton, \"shareButtonFunc\");\n        //AnimLayerTool.createShowMessageBox(120, -350, \"分享到群里可查看群排行榜！\", 0, this.node);\n        if (this.shareTicket != null) {\n            let shareNode = new cc.Node();\n            shareNode.addComponent(cc.Label).string = \"群排行\";\n            shareNode.setPosition(-260, 503);\n            this.node.addChild(shareNode);\n        }\n        if (CC_WECHATGAME) {\n            this.tex = new cc.Texture2D();\n            window.sharedCanvas.width = 960;\n            window.sharedCanvas.height = 640;\n            // 发消息给子域\n            cc.log(this.shareTicket)\n            if (this.shareTicket != null) {\n                window.wx.postMessage({\n                    messageType: 5,\n                    MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\n                    shareTicket: this.shareTicket\n                });\n            } else {\n                window.wx.postMessage({\n                    messageType: 1,\n                    MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\n                });\n            }\n        } else {\n            let gameTypeNode = new cc.Node();\n            gameTypeNode.addComponent(cc.Label).string = \"暂无排行榜数据\";\n            this.node.addChild(gameTypeNode);\n            cc.log(\"获取排行榜数据。\" + GameConfig.MAIN_MENU_NUM);\n        }\n    },\n\n    shareButtonFunc: function (event) {\n        GameTools.playSimpleAudioEngine(4);\n        setTimeout(() => {\n            GameTools.sharePicture(\"shareTicket\");\n        }, 100);\n    },\n\n    backButtonFunc: function (event) {\n        GameTools.playSimpleAudioEngine(0);\n        GameTools.removeRankData();\n        if (CC_WECHATGAME) {\n            window.wx.postMessage({// 发消息给子域\n                messageType: 4,\n                MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\n            });\n        }\n        this.node.destroy();\n    },\n\n    // 刷新子域的纹理\n    _updateSubDomainCanvas() {\n        if (CC_WECHATGAME) {\n            if (window.sharedCanvas != undefined) {\n                this.tex.initWithElement(window.sharedCanvas);\n                this.tex.handleLoadedTexture();\n                this.rankingScrollView.spriteFrame = new cc.SpriteFrame(this.tex);\n            }\n        }\n    },\n    update() {\n        this._updateSubDomainCanvas();\n    },\n    showAnimation(isShow) {\n        if (isShow) {\n            AnimLayerTool.bottonAnim(this.backButton);\n            AnimLayerTool.bottonAnim(this.shareButton);\n        }\n    }\n});\n"]}